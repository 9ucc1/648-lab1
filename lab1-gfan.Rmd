---
title: "lab1-gfan"
author: "gucci fan"
date: "2024-10-24"
output: html_document
---

Because I enjoy making things harder than they have to be, I wanted to find a dataset similar to the example Boulder data but for a different city and perform analysis on that. I took elevation data for a section of Phoenix, AZ from USGS but it was an extremely large and detailed dataset that took a long time to load. So, I used QGIS to reproject the elevation raster into 4 classes: 0-500ft, 500-1000ft, 1000-1500ft, and 1500-2400ft. I exported it as a .tif and visualized it in the RMD.


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(sf)
library(tidyverse)
library(raster)
library(viridis) 
```

```{r}
elevation_raster <- raster("test.tif")

elevation_df <- as.data.frame(as(elevation_raster, "SpatialPixelsDataFrame"))
colnames(elevation_df) <- c("elevation", "x", "y")
elevation_df$elevation_range <- ifelse(
  elevation_df$elevation == 1, 500,
  ifelse(elevation_df$elevation == 2, 1000,
         ifelse(elevation_df$elevation == 3, 1500,
                ifelse(elevation_df$elevation == 4, 2400, NA))))


ggplot(elevation_df) +
  geom_tile(aes(x = x, y = y, fill = elevation_range)) +
  scale_fill_viridis_c(option = "magma", name = "Elevation (ft)") +
  theme_minimal() +
  labs(title = "Phoenix Elevation")


```

```{r}

og_elev_raster <- raster("originalelev.tif")
og_elev_df <- as.data.frame(as(og_elev_raster, "SpatialPixelsDataFrame"))
colnames(og_elev_df) <- c("elevation", "x", "y")

og_elev_df$elevation_class_quantile <- cut(og_elev_df$elevation, breaks = quantile(og_elev_df$elevation, probs = seq(0, 1, by = 0.25)), include.lowest = TRUE)

ggplot(og_elev_df) +
  geom_tile(aes(x = x, y = y, fill = elevation)) +
  scale_fill_viridis_c(option = "magma", name = "Elevation (ft)") +
  theme_minimal() +
  labs(title = "Phoenix Elevation")
```

```{r}
df_sf <- st_as_sf(elevation_df, coords = c("x", "y "), crs = 4326)

ggplot(data = df_sf) +
  geom_sf(aes(color = elevation_class_quantile), size = 2) +  # Use elevation classes for coloring
  scale_color_manual(values = c("blue", "green", "yellow", "orange", "red")) +  # Customize colors
  theme_minimal() +
  labs(
    title = "Elevation Map",
    color = "Elevation Class"
  )

```


```{r}
boulder <- st_read("boulder/BoulderSocialMedia.shp")
boulder
```

```{r}
boulder = st_transform(boulder, 26753) 
ggplot() +
    geom_sf(data =boulder,
    fill = NA, alpha = .2) +
    theme_bw()
```